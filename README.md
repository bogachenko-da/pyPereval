# Проект виртуальной стажировки онлайн-школы Skillfactory

### Описание проекта

На сайте https://pereval.online/ ФСТР ведёт базу горных перевалов, которая пополняется туристами.

Мобильное приложение для оправки информации туристами о посещённых ими горных перевалов. В горах они будут вносить данные о перевале в приложение и отправлять их в ФСТР ( Федерация спортивного туризма России ), как только появится доступ в Интернет, для того чтобы поделиться информацией с другими людьми, увлеющимися туризмом и преодолением горных перевалов.

Когда турист поднимется на перевал, он сфотографирует его и внесёт нужную информацию с помощью мобильного приложения:

   - координаты объекта и его высоту;
   - название объекта;
   - несколько фотографий;
   - информацию о пользователе, который передал данные о перевале:
   - имя пользователя (ФИО строкой);
   - почта;
   - телефон.

Модератор из федерации будет верифицировать и вносить в базу данных информацию, полученную от пользователей, а те в свою очередь смогут увидеть в мобильном приложении статус модерации и просматривать базу с объектами, внесёнными другими.

### Реализация проекта.

Проект выполнен на языке программирования Python с использованием фреймворка Django. В проекте используется СУБД PostgreSQL. REST API реализован с помощью Django REST Framework. Встроен Swagger.

1. Созданы модели по работе с данными (models.py):
    - Users (класс пользователя) ;
    - Coords (класс координат);
    - Level (класс уровня сложности);
    - Images (класс для ссылок на фотографии);
    - PerevalAdded (класс перевал).


2. Созданы сериализаторы (serializers.py):
    - UsersSerializer;
    - CoordsSerializer;
    - LevelSerializer;
    - ImagesSerializer;
    - PerevalAddedSerializer;
    - В классе UsersSerializer переопределен метод save() для проверки существования пользователя с введенным email;
    - В классе PerevalAddedSerializer переопределен метод validate() для запрета редактирования данных пользователя.


3. Созданы представления (views.py):
    - UserViewset;
    - CoordsViewset;
    - LevelViewset;
    - ImagesViewset;
    - PerevaAddedlViewset;
    - В классе PerevaAddedlViewset переопределен метод partial_update() для запрета изменения данных, если в поле статус стоит значение не равное "new".
      В качестве результата возвращаются два значения:
      - state:
           - 1 — если успешно удалось отредактировать запись в базе данных.
           - 0 — в противном случае.


4. Создана маршрутизация URL-адресов (urls.py):
    - http://127.0.0.1:8000/swagger/ (для Swagger);
    - http://127.0.0.1:8000/redoc/ (для Redoc);
    - http://127.0.0.1:8000/ (Api Root);
    - http://127.0.0.1:8000/pereval/ (список всех добавленных перевалов Pereval Added Viewset List);
    - <http://127.0.0.1:8000/pereval/<id>/> (информация об отдельном перевале по id).
    - <http://127.0.0.1:8000/pereval/?user__email=<str:email>> (фильтровать добавленную информацию по электронной почте пользователя)
    - При этом есть возможность использовать CRUD методы.


5. Код покрыт тестами (tests.py). Создан класс PerevalAddedApiTestCase для тестирования функциональности веб-API:
    - test_get_list проверяет получение списка всех записей (перевалов), GET /pereval/;
    - test_get_detail(self) проверяет получение одной записи (перевала) по id, GET /pereval/<id>;
    - test_by_email проверяет фильтрацию по email, GET /pereval/?user__email=<email>.


6. Проект развернут на хостинге:
    - http://158.160.141.120:8000/swagger/ (для Swagger);
    - http://158.160.141.120:8000/redoc/ (для Redoc);
    - http://158.160.141.120:8000/ (Api Root);
    - http://158.160.141.120:8000/pereval/ (список всех добавленных перевалов Pereval Added Viewset List);
    - <http://158.160.141.120:8000/pereval/<id>/> (информация об отдельном перевале по id).
    - <http://158.160.141.120:8000/pereval/?user__email=<str:email>> (фильтровать добавленную информацию по электронной почте пользователя)


### Пример JSON файла с данными:

```{
    "beauty_title": "пер.",
    "title": "Крепкий",
    "other_titles": "Крепчайший",
    "connect": "Соединяет озеро Верхнее Крепкое и реку Тихая.",
    "user": {
        "email": "ivanov_sa@mail.ru",
        "fam": "Иванов",
        "name": "Сергей",
        "otc": "Александрович",
        "phone": "89629114777"
    },
    "coords": {
        "latitude": 49.928730,
        "longitude": 85.776583,
        "height": 2800
    },
    "level": {
        "winter": "1B",
        "summer": "1A",
        "autumn": "1A",
        "spring": "1A"
    },
    "images": [
        {
            "data": "https://tn.fishki.net/26/upload/post/2019/03/22/2919976/dsc04143.jpg",
            "title": "Фото перевала 1"
        },
        {
            "data": "https://tn.fishki.net/26/upload/post/2019/03/22/2919976/dsc04142.jpg",
            "title": "Фото перевала 2"
        }
    ]
}
```
